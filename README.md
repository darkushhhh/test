___

```
nmap -A -sV --version-all -O -p 8050 --reason -T4 --defeat-rst-ratelimit 92.51.39.106
```

___

<details>
<summary>screenshot Nmap(8050)</summary>
  
![](screenshots/SCANNING/nmap/nmap_8050.png)

</details>

___

`8050`.

___

### 3. Vulnerability - Unrestricted File Upload

**OWASP:** [A05:2021-Security Misconfiguration](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/)

**Уровень риска:** Критический

**Целевая страница:** `http://92.51.39.106:7788/index.html`

**Краткое описание:**

Уязвимость **Unrestricted File Upload** позволяет загружать на веб-ресурс произвольные файлы, включая вредоносные, такие как шеллы, скрипты и другие типы файлов, которые изначально не предназначены для обработки. В рамках исследования этой уязвимости будет использован PHP-shell.

**Реализация:**

<details>
<summary>Пошаговая реализация</summary>

- **Step 1. Загрузка файла**
    
Переходим на страницу загрузки файла и в окне выбора файла выбираем заранее подготовленный PHP-шелл.

В моем случае это open-source PHP shell - [p0wny-shell](https://github.com/flozz/p0wny-shell)

![](screenshots/TESTING/Unrestricted_File_Upload/8050/upload_file.png)

- **Step 2. Возможность доступа**

Ранее c помощью уязвимости **Command Injection** была обнаружена возможность выполнения произвольных команд на сервере. С помощью данной уязвимости находим расположение ранее установленного PHP-shell.

Путь до **p0wny-shell**: `http://92.51.39.106:7788/read?file=../../../../../../tmp/g253hv.php`

![](screenshots/TESTING/Unrestricted_File_Upload/8050/upload_url.png)
    
- **Step 3. Запуск PHP-shell**

Переходим по ранее обнаруженному пути до шелла и запускаем его:

![](screenshots/TESTING/Unrestricted_File_Upload/8050/pass.png)
    
    

- **Вывод**
    
Несмотря на ограниченный доступ к командной оболочке, обусловленный конфигурацией, предотвращающей выполнение определённых типов файлов, минимальный уровень доступа всё же был получен. Таким образом, наличие **уязвимости подтверждено**.



**Рекомендации по устранению:**

- **Ограничение типов файлов**: Разрешайте загрузку только файлов с заранее определёнными типами (например, `.jpg` `.png` `.gif`).
- **Ограничение размера файла**: Установите максимальный размер загружаемого файла, чтобы предотвратить загрузку больших вредоносных файлов.
- **Изоляция загруженных файлов**: Храните загруженные файлы вне веб-доступной директории.
- **Ограничение прав доступа**: Убедитесь, что загруженные файлы не имеют прав на выполнение.

___






