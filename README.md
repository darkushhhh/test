___

```
nmap -A -sV --version-all -O -p 8050 --reason -T4 --defeat-rst-ratelimit 92.51.39.106
```

___

<details>
<summary>screenshot Nmap(8050)</summary>
  
![](screenshots/SCANNING/nmap/nmap_8050.png)

</details>

___

`8050`.

___

### 2. Vulnerability - Command Injection

**OWASP:** [A01:2021-Broken Access Control](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)

**Уровень риска:** Критический

**Целевая страница:** `http://92.51.39.106:7788/server.html`

**Краткое описание:**

На веб-странице реализована функция проверки сервера, которая выполняет команду **ping** из консоли. В ходе тестирования установлено, что вводимые команды не подвергаются фильтрации или валидации, что создаёт возможность для эксплуатации **Command Injection**, позволяя выполнять произвольные системные команды.

**Пошаговая реализация:**

<details>
<summary>Пошаговая реализация</summary>


- **Step 1. Проверка функционала**
    
В ходе анализа выяснилось, что команды, вводимые пользователем, не подвергаются какой-либо фильтрации, что создаёт уязвимость, позволяющую получить несанкционированный доступ к конфиденциальным данным и выполнять произвольные действия на сервере.

Также выяснилось, что имеются `root` права в системе, что дает поистине не ограниченный функционал.
    

![](screenshots/TESTING/Session_Hijacking_Attack/admin_cookie.png)
   

- **Step 2. Доступ к файлам passwd и shadow**
    
Отсутствие фильтрации вводимых пользователем команд в сочетании с наличием прав суперпользователя, создаёт критическую уязвимость. Это позволяет выполнять произвольные системные команды и получать несанкционированный доступ к конфиденциальным файлам, таким как `/etc/passwd` и `/etc/shadow`, содержащим информацию об учётных записях и хэшах паролей.

![](screenshots/TESTING/Session_Hijacking_Attack/admin_cookie.png)
    
    
- **Вывод**
    
В результате успешной реализации уязвимости **Command Injection**, был получен доступ к файлам `/etc/passwd` и `/etc/shadow`, **уязвимость подтверждена**.


</details>


**Рекомендации по устранению:**

- **Валидация и санитизация входных данных**: Проверяйте и очищайте все входные параметры, используемые для доступа к ФС.
- **Ограничение доступа к файлам**: Убедитесь, что приложение обращается только к файлам в пределах безопасной директории.
- **Отключение прямого доступа к ФС**: Избегайте использования пользовательского ввода для прямого формирования путей к файлам.
- **Настройка прав доступа на сервере**: Ограничьте права доступа к файлам и директориям на уровне ОС.

___





