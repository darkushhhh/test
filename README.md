___

```
nmap -A -sV --version-all -O -p 8050 --reason -T4 --defeat-rst-ratelimit 92.51.39.106
```

___

<details>
<summary>screenshot Nmap(8050)</summary>
  
![](screenshots/SCANNING/nmap/nmap_8050.png)

</details>

___

`8050`.

___

### 2. Vulnerability - Path Traversal

**OWASP:** [A01:2021-Broken Access Control](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)

**Уровень риска:** Высокий

**Целевая страница:** `http://92.51.39.106:7788/server.html`

**Краткое описание:**

Из-за недостаточной фильтрации и валидации пользовательского ввода, существует возможность взаимодействия с файловой системой, включая доступ к файлам на хосте и исходному коду веб-страниц.

**Реализация:**

<details>
<summary>Пошаговая реализация</summary>

- **Step 1. Поиск пути**
    
Зная предполагаемую структуру файловой системы хоста, можно получить доступ к конфиденциальным файлам, таким как `/etc/passwd`.

Путь до `/etc/passwd`:
    
`http://92.51.39.106:7788/read?file=../../../../../../etc/passwd`

- **Step 2. Обход нормализации**

Для обхода возможных защитных механизмов на сервере, таких как нормализации путей, была применена URL-кодировка символов, что позволило бы успешно обойти защитные меры.
    
Итоговый запрос выглядит следующим образом: 
    
`http://92.51.39.106:7788/read file=..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`

![](screenshots/TESTING/Path_Traversal/7788/passwd.png)
   
- **Вывод**
    
В результате успешной реализации Path Traversal, был получен доступ к файлу `/etc/passwd`, **уязвимость подтверждена**.

</details>

**Рекомендации по устранению:**

- **Валидация и санитизация входных данных**: Проверяйте и очищайте все входные параметры, используемые для доступа к ФС.
- **Ограничение доступа к файлам**: Убедитесь, что приложение обращается только к файлам в пределах безопасной директории.
- **Отключение прямого доступа к ФС**: Избегайте использования пользовательского ввода для прямого формирования путей к файлам.
- **Настройка прав доступа на сервере**: Ограничьте права доступа к файлам и директориям на уровне ОС.

___





